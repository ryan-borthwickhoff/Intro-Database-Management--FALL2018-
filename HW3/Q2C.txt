SELECT C.CUSTID, D.CUSTNAME, C.Count_Returned
FROM 
(   (SELECT B.CUSTID, COUNT(A.ORDERID) AS Count_Returned
    FROM
    (
        ORDERS A
        INNER JOIN
        ORDERDET B
        ON A.ORDERID = B.ORDERID AND STATUS = 'Returned'
    )
	GROUP BY CUSTID
	ORDER BY COUNT(A.ORDERID) DESC ) C
    INNER JOIN
    CUSTOMERS D
    ON C.CUSTID = D.CUSTID
)
WHERE ROWNUM < 6;
