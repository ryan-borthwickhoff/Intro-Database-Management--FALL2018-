SELECT E.ORDERID, E.ORDDISCOUNT, E.ORDSHIPCOST, E.ORDQTY, E.ORDSALES, E.PRODUNITPRICE, E.PRODMARGIN, F.REGION, F.REGMANAGER,
(E.PRODUNITPRICE*E.ORDQTY*(1-E.ORDDISCOUNT) + E.ORDSHIPCOST) AS Theoretical_Price, 
(E.ORDSALES - (E.PRODUNITPRICE*E.ORDQTY*(1-E.ORDDISCOUNT) + E.ORDSHIPCOST)) AS Difference
FROM(
    (SELECT * 
    FROM(
            (SELECT * FROM(
                ORDERDET A
                INNER JOIN
                PRODUCTS B
                ON A.PRODID = B.PRODID
            )) C
            INNER JOIN
            CUSTOMERS D
            ON C.CUSTID = D.CUSTID
        )
    ) E
    INNER JOIN
    MANAGERS F
    ON F.REGID = E.CUSTREG
);
