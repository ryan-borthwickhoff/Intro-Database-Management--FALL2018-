SELECT C.CUSTID, D.CUSTNAME, C.TOT_REVENUE
FROM
(	(SELECT A.CUSTID, SUM(A.ORDSALES) AS Tot_Revenue
	FROM
	(
		ORDERDET A
		INNER JOIN
		ORDERS B
		ON A.ORDERID = B.ORDERID
	)
	WHERE STATUS IS null
	GROUP BY A.CUSTID
	ORDER BY SUM(A.ORDSALES) DESC) C
    INNER JOIN
    CUSTOMERS D
    ON C.CUSTID = D.CUSTID
)
WHERE ROWNUM < 11;
